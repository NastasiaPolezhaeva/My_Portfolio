# Портфолио: аналитик данных

##  Обо мне

Привет! Меня зовут Анастасия, я - начинающий аналитик.
Окончила Самарский медицинский университет по специальности "Лечебное дело". Прошла интернатуру и ординатуру по специальности "травматология и ортопедия". Работала 8 лет в клинической больнице.
Затем решила поменять вектор профессионального развития и в настоящий момент я завершаю обучение на платформе онлайн-университета skypro по специальности "Аналитик данных".
 
  В этом репозитории вы можете найти некоторые из моих проектов, выполненных во время обучения и практики
  
##  Навыки и технологии

-  Инструменты анализа данных: SQL, Excel
-  Языки программирования и библиотеки: Python, Pandas, Numpy, math, matplotlib, seaborn
-  Системы управления базами данных: MySQL, PostgreSQL
-  Средства визуализации данных: PowerPoint, Python, PowerBi

## Проекты

 ### Проект 1: Калькулятор юнит-экономики онлайн-школы
Что нужно было сделать:

>**Задача №1**. Настроить в калькуляторе учет корректировок планов маркетинга.
 
>**Задача №2**. Пересчитать план найма преподавателей.

Как решала:
1. *Добавила в список параметров калькулятора показатель "Поправочный коэффициент на привлечение".
Установила значение этого показателя по умолчанию, как 100% и добавила возможность изменять этот показатель через столбец "Изменение".
Настроила динамический расчёт количества новых студентов за период 05.21-04.22 с поправкой на этот коэффициент, т.е.в каждый месяц этого периода 
рассчётное значение количества новых студентов стало больше на 20%(с помощью функции ВПР притянула в таблицу план маркетинга по новым студентам 
и умножила на поправочный коэффициент).
Просчитала сценарий, при котором планы маркетинга будут увеличены на 12% при сохранении всех остальных настроек без изменений.*
2. *Добавила в калькулятор Найма преподавателей (Найм План) возможность изменять входные параметры: Пропускную способность П и Retention П - 
с помощью дополнительного столбца с процентными изменениями. Сделала поправку в расчёте общей пропускной способности (изменила формулу так,
чтобы отразить, что новые преподаватели в первый месяц своей работы могут проводить только половину уроков от средней пропускной способности
преподавателя, задаваемой параметром).  Обновила прогнозное количество уроков в соответствии с полученным количеством студентов из Задачи 1. 
Просчитала сценарий, при котором Пропускная способность П увеличится на 15 процентов, а Retention П упадёт на 2 процента. И, наконец, 
с помощью функции "Поиска решений" составила новый план найма с ограничением: за месяц нельзя нанять более 70 преподавателей.*


[UNIT_CALCULATOR_ONLINE_SCHOOL](https://github.com/NastasiaPolezhaeva/My_Portfolio/tree/main/Project%201)


**Выводы(итоги)**:

**Итог №1**: Новое количество планируемых студентов с поправкой на коэфициент 12% (на листе Главный) и 
возможность корректировать план маркетинга.

**Итог №2**: Новый план найма преподавателей в соответствии с заданными условиями (на листе Найм План)
_____

 ### Проект 2: Калькулятор юнит-экономики онлайн-кинотеатра

Что нужно было сделать:

>**Задача №1**. Посчитать юнит-экономику онлайн-кинотеатра, который работает по модели ежемесячной подписки.

>**Задача №2.** Предложить сценарий по настройке параметров для выхода на 25-процентную маржинальность.

Как решала: 

1.*Просчитала все фактические показатели необходимых метрик для юнит-калькулятора на основании имеющихся данных с апреля по август 2021г года. Ввела столбец "Планируемые показатели" и связала его со столбцом "Изменение", чтобы иметь возможность с помощью коэффициентов влиять на прогноз. С помощью исторических данных спрогнозировала все показатели на период с сентября 2021г по январь 2022г. Построила таблицу основных показателей "to be - as is".*

2.*С помощью функции "Поиска решений" и столбца "Изменение" настроила параметры с условием выхода маржинальности на 25 %.*


[UNIT_CALCULATOR_ONLINE_CINEMA](https://github.com/NastasiaPolezhaeva/My_Portfolio/tree/main/Project%202)


**Выводы (итоги)**: Юнит-экономика продукта неэффективна и убыточна. Средняя маржинальность за период с мая по август 2021 года составила -90,45%. 
Количество новых подписок уменьшается. Retention падает. Высокие расходы на маркетинг ( почти 50%), высокие фиксированные расходы ( 47%).
Для выхода на получение 25-ти % маржинальности необходимо снизить средний CPA (он же CAC для нашего продукта) на 45%, повысить Retention не менее, чем на 7% и повысить стандартную цену подписки. 
_____

### Проект 3: Когортный анализ онлайн-кинотеатра

Что нужно было сделать:

>**Задача №1**. Необходимо проанализировать клиентский LTV по когортам времени захода на платформу онлайн-кинотеатра и сделать выводы, какие когорты лучше, а какие хуже с точки зрения LTV

Как решала: 

*Построила сводную таблицу с абсолютными доходимостями клиентов по месячным когортам, а затем таблицу с клиентским Retention. На основании Retention рассчитала лайфтайм с помощью метода усредненных прямоугольников для каждой когорты. Рассчитала LTR для каждой когорты с помощью ARPU (предположила, что ARPU = 300). Рассчитала LTV с помощью усредненных костов для каждой когорты.*

[COHORT_ANALISIST](https://github.com/NastasiaPolezhaeva/My_Portfolio/tree/main/Project%203)

**Выводы (итоги)**: Распределение хороших и плохих когорт с точки зрения LTV.
![COHORTA](https://github.com/NastasiaPolezhaeva/My_Portfolio/blob/main/Project%203/COHORTA.jpg)
____

### Проект 4: Построение витрины для модели машинного обучения в банке

Что нужно было сделать: 

>**Задача №1**. Написать скрипт, который сделает витрину со следующими полями:

- Внутренний идентификатор клиента — поле id_client.
- Название города — поле name_city из таблицы skybank.region_dict.
- Числовой признак, который принимает значение 1 для мужчин и 0 для женщин — новое поле nflag_gender на основании поля gender.
- Возраст — поле age.
- Числовая переменная, которая показывает, в первый ли раз клиент обратился к нам за кредитом, — поле first_time.
- Числовой признак, который принимает значение 1 при наличии мобильного телефона и 0 при его отсутствии — новое поле nflag_cellphone на основании поля cellphone.
- Числовая переменная, которая показывает, активен ли клиент, — поле is_active;
- Номер клиентского сегмента — поле cl_segm.
- Размер выданного кредита — поле amt_loan.
- Дата выдачи кредита — поле date_loan. Необходимо привести к формату даты.
- Тип выданного кредита — поле credit_type.
- Суммарный объем кредитов, выданных в этом городе.
- Доля данного кредита среди всех кредитов, выданных в этом городе.
- Суммарный объем кредитов, выданных в рамках указанного типа кредита.
- Доля данного кредита среди всех кредитов, выданных в рамках указанного типа кредита.
- Суммарный объем кредитов, выданных в рамках указанного типа кредита и города.
- Доля данного кредита среди всех кредитов, выданных в рамках указанного типа кредита и города.
- Количество кредитов, выданных в этом городе.
- Количество кредитов, выданных в рамках указанного типа кредита.
- Количество кредитов, выданных в рамках указанного типа кредита и города.

Как решала: 

*С помощью подзапроса вывела требуемые поля; суммы и количества посчитала с помощью оконных функций; последним этапом расчитала запрашивемые доли.* 
```SQL
select c.*
      ,amt_loan::float/sum_city as part_amt_city
      ,amt_loan::float/sum_type as part_amt_type
      ,amt_loan::float/sum_type_name as part_amt_type_name
from (select a.id_client
      ,b.name_city
      ,case when a.gender = 'M' then 1 else 0 end as nflag_gender
      ,age
      ,first_time
      ,case when cellphone is not null then 1 else 0 end as nflag_cellphone
      ,is_active
      ,cl_segm
      ,amt_loan
      ,date_loan::date
      ,credit_type
      ,sum(amt_loan) over(partition by name_city) as sum_city
      ,sum(amt_loan) over(partition by credit_type) as sum_type
      ,sum(amt_loan) over(partition by credit_type, name_city) as sum_type_name
      ,count(amt_loan) over(partition by name_city) as cnt_credit_city
      ,count(amt_loan) over(partition by credit_type) as cnt_credit_type
      ,count(amt_loan) over(partition by credit_type, name_city) as cnt_credit_type_city
from skybank.late_collection_clients a
  left join skybank.region_dict b
    on a.id_city = b.id_city) c
```

**Выводы (итоги)**: Готовая витрина [SHOWCASE](https://metabase.sky.pro/question/64102)
____

### Проект 5: Моделирование изменения балансов студентов

Что нужно было сделать:

>**Задача №1** Посмотреть на изменения балансов студентов (на примере топ-1000 строк), собранных из CTE. Ответить на вопросы: 
Какие данные вас смущают? Какие вопросы стоит задавать дата-инженерам и владельцам таблиц?

>**Задача №2.** Создать визуализацию (линейную диаграмму) итогового результата. Какие выводы можно сделать из получившейся визуализации? 

Как решала: 

*Использовала конструкцию CTE. Узнала, когда была первая транзакция для каждого студента. Собрала таблицу с датами за каждый календарный день 2016 года. Узнала, за какие даты имеет смысл собирать баланс для каждого студента (даты после первой успешной транзакции). Нашла все изменения балансов, связанные с успешными транзакциями (нашла все транзакции и сгруппировала по юзеру и дате). Нашла баланс студентов, сформированный только транзакциями - куммулятивная сумма балансов транзакций. Посчитала количество пройденных за каждый день уроков для каждого ученика,а также куммулятивную сумму этих уроков для каждого ученика. Вычислила балансы каждого студента ( объединила куммулятивные суммы количества транзакций и количества уроков). Сделала выводы.*

```SQL
with first_payments as
     (select user_id
            ,min(transaction_datetime)::date as first_payment_date
      from skyeng_db.payments
      where status_name = 'success'  
      group by 1
      order by 1
      ),
all_dates as
     (select distinct (class_start_datetime)::date as dt
      from skyeng_db.classes
      where date_part('year', class_start_datetime) = '2016'
      order by dt asc
      ),
all_dates_by_user as
      (select user_id
              ,dt
       from  all_dates  
         join first_payments 
           on dt >= first_payment_date
      ),
payments_by_dates as
       (select  user_id
              ,transaction_datetime::date as payment_date
              ,sum(classes) as transaction_balance_change
        from skyeng_db.payments
        where status_name = 'success'  
        group by 1,2
        order by user_id
        ),
payments_by_dates_cumsum as
        (select adu.user_id
                ,dt
                ,coalesce(transaction_balance_change,0) as transaction_balance_change
                ,sum(transaction_balance_change) over (partition by adu.user_id order by dt rows between unbounded preceding and current row) as transaction_balance_change_cs
          from all_dates_by_user adu 
            left join payments_by_dates pd 
              on dt = payment_date
              and adu.user_id = pd.user_id
        ),
classes_by_dates as
        (select user_id
            ,class_start_datetime::date as class_date
            ,count(id_class)*-1 as classes
         from skyeng_db.classes
         where class_status in ('success', 'failed_by_student')
               and class_type <> 'trial'
         group by 1,2       
        ),
classes_by_dates_cumsum as
        (select adu.user_id
               ,dt
               ,coalesce(classes,0) as classes
               ,sum(classes) over (partition by adu.user_id order by dt rows between unbounded preceding and current row) as classes_cs
          from all_dates_by_user adu 
            left join classes_by_dates cd 
              on dt = class_date
              and adu.user_id = cd.user_id
        ),
balances as
        (select pd_cs.user_id
               ,pd_cs.dt
               ,transaction_balance_change
               ,transaction_balance_change_cs
               ,classes
               ,classes_cs
               ,classes_cs + transaction_balance_change_cs as balance 
         from payments_by_dates_cumsum pd_cs
            join classes_by_dates_cumsum  cd_cs
              on pd_cs.dt = cd_cs.dt
              and pd_cs.user_id = cd_cs.user_id
        )
-- select *
-- from balances
-- order by 1,2
-- limit 1000
select dt
      ,sum(transaction_balance_change) as sum_transaction_balance_change
      ,sum(transaction_balance_change_cs) as sum_transaction_balance_change_cs
      ,sum(classes) as sum_classes
      ,sum(classes_cs) as sum_classes_cs
      ,sum(balance) as sum_balance 
from balances
group by 1 
order by 1 

```
[BALANCE](https://metabase.sky.pro/question/64839)

**Выводы**:

**Итог №1**: Вопросы к таблице Payments:
Почему в таблице о транзакциях имеются пустые строки в поле id_transaction?
Что значит status_name = created? созданный? Почему при отсутствии оплаты операции присвоен id_transaction?   

**Итог №2**: Выводы по визуализации: Онлайн-школа работает успешно, о чем говорит:
             <p>-рост кумулятивной суммы транзакций (на конец года составляет 21 798) <p>
              <p>-рост кумулятивной суммы транзакций (на конец года составляет 21 798) <p>
              <p>-рост баланса к концу 2016 года 4 126, то есть студенты продолжают покупать уроки на следующий год <p>
              <p>-опираясь на кривую sum_classes можно сделать вывод, что студенты предпочитают проходить уроки в будние дни, а в праздники и выходные наблюдается снижение количества проходимых уроков. <p>
____

### Проект 6: A/B-test 

>**Бизнес-проблема:** мы считаем, что конверсии из визита в покупку в нашем магазине недостаточно высоки. Мы посмотрели на страницы конкурентов и поняли, что у нас есть возможность увеличить объем продаж, если мы еще немного изменим дизайн страницы с каталогом продукции.

>**Гипотеза:** предполагается, что добавление видео с процессом приготовления вкусностей мотивирует к их покупке и позволяет добиться двух эффектов:

- повышение конверсии из визита в оплату (больше людей захотят купить нашу продукцию)
- как минимум, не снижение среднего чека покупки, а в идеале — увеличение

>**Ожидаемые действия пользователей:** мы ожидаем, что, увидев видео с процессом приготовления вкусностей вместе с описанием продукции, больше людей захотят сделать покупку, а возможно — в среднем будут покупать больше продукции в одном заказе.

>**Эксперимент будет считаться успешным, если:**

- конверсия из визита в покупку с окном в 7 дней повысится
- средний чек покупки не снизится

Как решала: 

*1. Рассчитала окно конверсии на исторических данных с построением гистограммы распределения времени между первым заходом на сайт и покупкой.
 2. Исследовала распределение пользователей по группам по основным сегментам: гео-группа, канал привлечения, платформа
 3. Вычислила p-value и стат.критерий для каждой группы с помощью теста хи-квадрат, сравнила с уровнем значимости
 4. Расчитала мощность теста
 5. С помощью метода bootstrap построила распределение разниц средних чеков в контрольной и тестовой группах*
 
[A/B-test](https://github.com/NastasiaPolezhaeva/My_Portfolio/blob/main/Project%206/ABtest.ipynb)

 **Выводы**:
 Гипотеза о том, что добавление видео с процессом приготовления вкусностей мотивирует пользователей к их покупке подтверждается - мы наблюдаем оба эффекта, которых хотели добиться:
                       - повысилась конверсия из визита в оплату (больше людей купили нашу продукцию)
                       - отмечатеся увеличение среднего чека покупки.
 Экперимент можно считать успешным, а соответственно и внедрять изменение каталога.

 ___________
## Контактная информация
Email: nastasya_polezhayeva@list.ru

